<% provide(:title, "Items") %>

<p id="notice"><%= notice %></p>

<div class="row">
  <h1 class="text-center">Full Catalogue</h1>

  <%= form_tag(items_path(:category_filter), :method => "get") do %>
  <table>
    <tr>
      <td>Non-Fiction<%= radio_button_tag(:category_filter, "Non-Fiction") %></td>
      <td>Anthologies<%= radio_button_tag(:category_filter, "Anthologies") %> </td>
      <td>Fiction<%= radio_button_tag(:category_filter, "Fiction") %> </td>
      <td>Poetry<%= radio_button_tag(:category_filter, "Poetry") %> </td>
      <td>Periodicals<%= radio_button_tag(:category_filter, "Periodicals") %> </td>
    </tr>
  </table>
  <%= submit_tag "Most Expensive", :name => 'expensive' %>
  <%= submit_tag "Cheapest", :name => 'cheapest' %>
  <%= submit_tag "Top rated", :name => 'bestrated' %>
  <%= submit_tag "Lowest rated", :name => 'lowestrated' %>
<% end %>
      <% @items.each do |item| %>
         <div class="col-sm-4 col-md-4 col-lg-4">
            <h3 class="item-title"><%= item.title %></h3>
            <p><%= link_to (image_tag item.image_url, :class => "", :size=>"280x400"), item %></p>
            <h4>Author: <%= item.author %></h4>
            <h4>Price: <%= number_to_currency(item.price, :unit => "â‚¬") %></h4>
            <h4>Category: <%= item.category %></h4>
            <h4> 
                Rating:<% item.score.to_i.times do  %>
                            <span class="glyphicon glyphicon-star"></span>
                        <% end %>
                <% item.blank_stars.times do %>
                    <span class="glyphicon glyphicon-star-empty"></span>
                <% end %> (<%= item.reviews.size %>) 
            </h4>
            <h4>Current Stock: <%= item.stock %></h4>
            <%= form_for item, remote: true do |f| %>
            <div class="field">
                <%= f.label :stock %>
                <%= f.text_field :stock %>
            </div>

           <div class="actions">
              <p><%= f.submit 'Update Stock'%></p>
           </div>
      <% end %>
         <p>
            <%= link_to 'Details',  item, :class => "btn btn-md btn-success", :role => "button" %>
            <%if item.stock_limit %>
                <%= link_to 'Out of stock', cart_add_path(item.id), :class => "btn btn-md btn-danger disabled", :disabled => true %>
            <% else %>
               <button class="btn btn-md btn-primary" type="button" onclick="loadDoc('<%= item.id%>', '<%= item.title%>')">Add to cart</button> 
               <!--<%= link_to 'Add to cart', cart_add_path(item.id), :class => "btn btn-md btn-primary" %> -->
            <% end %>
         </p>
         <p>
            <%= link_to 'Edit',  edit_item_path(item), :class => "btn btn-md btn-warning", :role => "button" %>
            <%= link_to 'Destroy',  item, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-md btn-danger", :role => "button" %>
         </p>
         </div>
      <% end %>
</div>
<!--<p><%= link_to 'New Item',  new_item_path, :class => "btn btn-md btn-primary", :role => "button" %>[Admin funtion : ]</p>-->

<script src="/SSD-Project/app/assets/javascripts/addToCartAJAX.js"></script>